<?xml version="1.0"?>
<pattern  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    
    <patterndata>
        <data>
            <name>username</name>
            <value>interoptool@gmail.com</value>
        </data>
        <data>
            <name>password</name>
            <value>testingtool</value>
        </data>
    </patterndata>
    
    <architecture>
        <component>
            <id>ObjectStorageGE</id>
            <address>**ADDRESS**</address>
            <interface>
                <id>CDMI</id>
                <url>**URL**</url>
            </interface>
        </component>
        <component>
            <id>IdMGE</id>
            <address>cloud.lab.fi-ware.org</address>
            <interface>
                <id>idm</id>
                <url>http://cloud.lab.fi-ware.org:4730/v2.0</url>
            </interface>
        </component>
    </architecture>
    
     <behaviour>
        <state>
          <label>A1</label>
          <type>triggerstart</type>
          <transition>    
                <to>A2</to>
                <message>
                    <url>component.IdMGE.idm</url>
                    <path>/tokens</path>
                    <method>post</method>
                    <type>json</type>
                    <body><![CDATA[{"auth":{
                            "passwordCredentials":{
                                "username":"$$patterndata.username$$",
                                "password":"$$patterndata.password$$"
                            }
                    }}]]>
                    </body>
                </message>
              </transition>
        </state>

        <state>
          <label>A2</label>
          <type>normal</type>
            <transition>    
                <to>A3</to>
                <guards>
                    <equal>
                        <param>HTTP.from</param>
                        <value>component.IdMGE.address</value>
                    </equal>
                    <equal>
                        <param>HTTP.msg</param>
                        <value>REPLY</value>
                    </equal>
                    <equal>
                        <param>HTTP.Code</param>
                        <value>200</value>
                    </equal>
                </guards>
              </transition>
        </state>
        <state>
          <label>A3</label>
          <type>trigger</type>
          <transition>    
                <to>A4</to>
                <message>
                    <url>component.IdMGE.idm</url>
                    <path>/tenants</path>
                    <method>get</method>
                    <type>json</type>
                    <headers>
                        <header>
                            <name>X-Auth-Token</name>
                            <value>$$A2|content|access.token.id$$</value>
                        </header>
                    </headers>
                </message>
              </transition>
        </state>

        <state>
          <label>A4</label>
          <type>normal</type>
            <transition>    
                <to>A5</to>
                <guards>
                    <equal>
                        <param>HTTP.from</param>
                        <value>component.IdMGE.address</value>
                    </equal>
                    <equal>
                        <param>HTTP.msg</param>
                        <value>REPLY</value>
                    </equal>
                    <equal>
                        <param>HTTP.Code</param>
                        <value>200</value>
                    </equal>
                </guards>
              </transition>
        </state>
        
        <state>
          <label>A5</label>
          <type>trigger</type>
          <transition>    
                <to>A6</to>
                <message>
                    <url>component.IdMGE.idm</url>
                    <path>/tokens</path>
                    <method>post</method>
                    <type>json</type>
                    <body>
                        <![CDATA[{"auth": {
                                "tenantName": "$$A4|content|tenants[0].id$$",
                                "passwordCredentials": {
                                    "username":"$$patterndata.username$$",
                                    "password":"$$patterndata.password$$"
                                }
                            }
                        }]]>
                    </body>
                </message>
              </transition>
        </state>

        <state>
          <label>A6</label>
          <type>normal</type>
            <transition>    
                <to>A7</to>
                <guards>
                    <equal>
                        <param>HTTP.from</param>
                        <value>component.IdMGE.address</value>
                    </equal>
                    <equal>
                        <param>HTTP.msg</param>
                        <value>REPLY</value>
                    </equal>
                    <equal>
                        <param>HTTP.Code</param>
                        <value>200</value>
                    </equal>
                </guards>
              </transition>
        </state>
        
        <state>
          <label>A7</label>
          <type>trigger</type>
          <transition>    
                <to>A8</to>
                <message>
                    <url>component.ObjectStorageGE.CDMI</url>
                    <path>/AUTH_$$A4|content|tenants[0].id$$/cdmi_capabilities/container/</path>
                    <method>get</method>
                    <type>json</type>
                    <headers>
                        <header>
                            <name>X-Auth-Token</name>
                            <value>$$A6|content|access.token.id$$</value>
                        </header>
                        <header>
                            <name>X-CDMI-Specification-Version</name>
                            <value>1.0.1</value>
                        </header>
                    </headers>
                </message>
              </transition>
        </state>

        <state>
          <label>A8</label>
          <type>normal</type>
            <transition>    
                <to>A9</to>
                <guards>
                    <equal>
                        <param>HTTP.from</param>
                        <value>component.ObjectStorageGE.address</value>
                    </equal>
                    <equal>
                        <param>HTTP.msg</param>
                        <value>REPLY</value>
                    </equal>
                    <equal>
                        <param>HTTP.Code</param>
                        <value>200</value>
                    </equal>
                </guards>
              </transition>
        </state>
        <state>
          <label>A9</label>
          <type>trigger</type>
          <transition>    
                <to>A10</to>
                <message>
                    <url>component.ObjectStorageGE.CDMI</url>
                    <path>/AUTH_$$A4|content|tenants[0].id$$</path>
                    <method>get</method>
                    <type>json</type>
                    <headers>
                        <header>
                            <name>X-Auth-Token</name>
                            <value>$$A6|content|access.token.id$$</value>
                        </header>
                        <header>
                            <name>X-CDMI-Specification-Version</name>
                            <value>1.0.1</value>
                        </header>
                    </headers>
                    <body><![CDATA[{
                        "metadata" : {
                        }
                     }]]>
                    </body>
                </message>
              </transition>
        </state>

        <state>
          <label>A10</label>
          <type>normal</type>
            <transition>    
                <to>A11</to>
                <guards>
                    <equal>
                        <param>HTTP.from</param>
                        <value>component.ObjectStorageGE.address</value>
                    </equal>
                    <equal>
                        <param>HTTP.msg</param>
                        <value>REPLY</value>
                    </equal>
                    <equal>
                        <param>HTTP.Code</param>
                        <value>200</value>
                    </equal>
                </guards>
              </transition>
        </state>
        
        <state>
          <label>A11</label>
          <type>trigger</type>
          <transition>    
                <to>A11b</to>
                <message>
                    <url>component.ObjectStorageGE.CDMI</url>
                    <path>/AUTH_$$A4|content|tenants[0].id$$/TestContainer/</path>
                    <method>put</method>
                    <type>json</type>
                    <headers>
                        <header>
                            <name>X-Auth-Token</name>
                            <value>$$A6|content|access.token.id$$</value>
                        </header>
                        <header>
                            <name>X-CDMI-Specification-Version</name>
                            <value>1.0.1</value>
                        </header>
                    </headers>
                    <body><![CDATA[ {
                        "metadata" : {
                        }
                     }]]>
                    </body>
                </message>
              </transition>
        </state>
        <state>
          <label>A11b</label>
          <type>normal</type>
            <transition>    
                <to>A11c</to>
                <guards>
                    <equal>
                        <param>HTTP.from</param>
                        <value>component.ObjectStorageGE.address</value>
                    </equal>
                    <equal>
                        <param>HTTP.msg</param>
                        <value>REPLY</value>
                    </equal>
                    <equal>
                        <param>HTTP.Code</param>
                        <value>202</value>
                    </equal>
                </guards>
              </transition>
              <transition>    
                <to>A11c</to>
                <guards>
                    <equal>
                        <param>HTTP.from</param>
                        <value>component.ObjectStorageGE.address</value>
                    </equal>
                    <equal>
                        <param>HTTP.msg</param>
                        <value>REPLY</value>
                    </equal>
                    <equal>
                        <param>HTTP.Code</param>
                        <value>201</value>
                    </equal>
                </guards>
              </transition>
        </state>
        
        <state>
          <label>A11c</label>
          <type>trigger</type>
          <transition>    
                <to>A12</to>
                <message>
                    <url>component.ObjectStorageGE.CDMI</url>
                    <path>/AUTH_$$A4|content|tenants[0].id$$/TestContainer/TestObject.json</path>
                    <method>put</method>
                    <type>json</type>
                    <headers>
                        <header>
                            <name>X-Auth-Token</name>
                            <value>$$A6|content|access.token.id$$</value>
                        </header>
                        <header>
                            <name>X-CDMI-Specification-Version</name>
                            <value>1.0.1</value>
                        </header>
                    </headers>
                    <body><![CDATA[ {
                        "mimetype" : "text/plain",
                        "metadata" : {

                        },
                        "value" : "Hello CDMI World!"
                     }]]>
                    </body>
                </message>
              </transition>
        </state>

        <state>
          <label>A12</label>
          <type>normal</type>
            <transition>    
                <to>A13</to>
                <guards>
                    <equal>
                        <param>HTTP.from</param>
                        <value>component.ObjectStorageGE.address</value>
                    </equal>
                    <equal>
                        <param>HTTP.msg</param>
                        <value>REPLY</value>
                    </equal>
                    <equal>
                        <param>HTTP.Code</param>
                        <value>201</value>
                    </equal>
                </guards>
              </transition>
        </state>
        
        <state>
          <label>A13</label>
          <type>trigger</type>
          <transition>    
                <to>A14</to>
                <message>
                    <url>component.ObjectStorageGE.CDMI</url>
                    <path>/AUTH_$$A4|content|tenants[0].id$$/TestContainer/TestObject.json</path>
                    <method>get</method>
                    <type>json</type>
                    <headers>
                        <header>
                            <name>X-Auth-Token</name>
                            <value>$$A6|content|access.token.id$$</value>
                        </header>
                    </headers>
                </message>
              </transition>
        </state>

        <state>
          <label>A14</label>
          <type>normal</type>
            <transition>    
                <to>A15</to>
                <guards>
                    <equal>
                        <param>HTTP.from</param>
                        <value>component.ObjectStorageGE.address</value>
                    </equal>
                    <equal>
                        <param>HTTP.msg</param>
                        <value>REPLY</value>
                    </equal>
                    <equal>
                        <param>HTTP.Code</param>
                        <value>200</value>
                    </equal>
                </guards>
              </transition>
        </state>
        
        <state>
          <label>A15</label>
          <type>trigger</type>
          <transition>    
                <to>A16</to>
                <message>
                    <url>component.ObjectStorageGE.CDMI</url>
                    <path>/AUTH_$$A4|content|tenants[0].id$$/TestContainer/TestObject.json</path>
                    <method>delete</method>
                    <type>json</type>
                    <headers>
                        <header>
                            <name>X-Auth-Token</name>
                            <value>$$A6|content|access.token.id$$</value>
                        </header>
                        <header>
                            <name>X-CDMI-Specification-Version</name>
                            <value>1.0.1</value>
                        </header>
                    </headers>
                </message>
              </transition>
        </state>

        <state>
          <label>A16</label>
          <type>normal</type>
            <transition>    
                <to>A17</to>
                <guards>
                    <equal>
                        <param>HTTP.from</param>
                        <value>component.ObjectStorageGE.address</value>
                    </equal>
                    <equal>
                        <param>HTTP.msg</param>
                        <value>REPLY</value>
                    </equal>
                    <equal>
                        <param>HTTP.Code</param>
                        <value>204</value>
                    </equal>
                </guards>
              </transition>
        </state>
        
        <state>
          <label>A17</label>
          <type>trigger</type>
          <transition>    
                <to>A18</to>
                <message>
                    <url>component.ObjectStorageGE.CDMI</url>
                    <path>/AUTH_$$A4|content|tenants[0].id$$/TestContainer</path>
                    <method>delete</method>
                    <type>json</type>
                    <headers>
                        <header>
                            <name>X-Auth-Token</name>
                            <value>$$A6|content|access.token.id$$</value>
                        </header>
                        <header>
                            <name>X-CDMI-Specification-Version</name>
                            <value>1.0.1</value>
                        </header>
                    </headers>
                </message>
              </transition>
        </state>

        <state>
          <label>A18</label>
          <type>normal</type>
            <transition>    
                <to>A99</to>
                <guards>
                    <equal>
                        <param>HTTP.from</param>
                        <value>component.ObjectStorageGE.address</value>
                    </equal>
                    <equal>
                        <param>HTTP.msg</param>
                        <value>REPLY</value>
                    </equal>
                    <equal>
                        <param>HTTP.Code</param>
                        <value>204</value>
                    </equal>
                </guards>
              </transition>
        </state>

        <state>
            <label>A99</label>
            <type>end</type>
        </state>
    </behaviour>
</pattern>
