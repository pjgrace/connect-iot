<?xml version="1.0"?>
<pattern xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:noNamespaceSchemaLocation ="Pattern.xsd">
    
    <architecture>
        <component>
            <id>idmGE</id>
            <address>account.lab.fiware.org</address>
            <interface>
                <id>idmauthorise</id>
                <url>https://account.lab.fiware.org:443/oauth2</url>
            </interface>
        </component>
        <component>
            <id>callback</id>
            <address>192.9.206.88</address>
            <interface>
                <id>callback</id>
                <url>http://192.9.206.88:81/login</url>
            </interface>
        </component>
        <component>
            <id>idm_client</id>
            <address>192.9.206.88</address>
        </component>
    </architecture>
    
    <behaviour>
        <state>
          <label>A1</label>
          <type>start</type>
          <transition>    
                <to>A2</to>
                <guards>
                    <equal>
                        <param>HTTP.to</param>
                        <value>component.callback.address</value>
                    </equal>
                    <equal>
                        <param>HTTP.toInterface</param>
                        <value>component.callback.callback</value>
                    </equal>
                    <equal>
                        <param>HTTP.msg</param>
                        <value>GET</value>
                    </equal>
                </guards>
              </transition>
        </state>
        <state>
          <label>A2</label>
          <type>normal</type>
            <transition>    
                <to>A3</to>
                <guards>
                    <equal>
                        <param>HTTP.to</param>
                        <value>component.idm_client.address</value>
                    </equal>
                    <equal>
                        <param>HTTP.msg</param>
                        <value>REPLY</value>
                    </equal>
                    <equal>
                        <param>HTTP.code</param>
                        <value>1001</value>
                    </equal>
                </guards>
              </transition>
        </state>
        <state>
          <label>A3</label>
          <type>normal</type>
            <transition>    
                <to>A4</to>
                <guards>
                    <equal>
                        <param>HTTP.to</param>
                        <value>component.idm_client.address</value>
                    </equal>
                    <equal>
                        <param>HTTP.msg</param>
                        <value>REPLY</value>
                    </equal>
                    <equal>
                        <param>HTTP.code</param>
                        <value>1001</value>
                    </equal>
                </guards>
              </transition>
        </state>
        <state>
          <label>A4</label>
          <type>end</type>
        </state>
    </behaviour>
</pattern>
