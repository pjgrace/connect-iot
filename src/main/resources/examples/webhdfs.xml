<?xml version="1.0"?>
<pattern xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation ="Pattern.xsd">
	<architecture>		
		<component>
			<id>webhdfs</id>
			<address>cosmos.lab.fi-ware.org</address>
				<interface>
					<id>hdfsurl</id>
					<url>http://cosmos.lab.fi-ware.org:14000</url>
				</interface>
		</component>
	</architecture>
	<behaviour>		
		<state>
			<label>triggerstart2</label>
			<type>triggerstart</type>
			<transition>
				<to>normal3</to>
				<message>
					<url>component.webhdfs.hdfsurl</url>
					<path>/webhdfs/v1/user/pjgrace/input_data?op=MKDIRS&amp;user.name=pjgrace</path>
					<method>PUT</method>
					<type>XML</type>
					<headers>
						<header>
							<name>Content-type</name>
							<value>application/json</value>
						</header>
					</headers>
					<body><![CDATA[]]></body>
				</message>
			</transition>
		</state>		
		<state>
			<label>normal3</label>
			<type>normal</type>
			<transition>
				<to>trigger7</to>
				<guards>
					<equal>
						<param>Content[$.boolean]</param>
						<value>true</value>
					</equal>
					<equal>
						<param>HTTP.Code</param>
						<value>200</value>
					</equal>
				</guards>
			</transition>
		</state>		
		<state>
			<label>end5</label>
			<type>end</type>
		</state>		
		<state>
			<label>trigger7</label>
			<type>trigger</type>
			<transition>
				<to>normal9</to>
				<message>
					<url>component.webhdfs.hdfsurl</url>
					<path>/webhdfs/v1/user/pjgrace/input_data/iistructured_data.txt?op=CREATE&amp;user.name=pjgrace</path>
					<method>PUT</method>
					<type>JSON</type>
					<headers>
						<header>
							<name>Content-type</name>
							<value>application/json</value>
						</header>
					</headers>
					<body></body>
				</message>
			</transition>
		</state>		
		<state>
			<label>normal9</label>
			<type>normal</type>
			<transition>
				<to>trigger11</to>
				<guards>
					<equal>
						<param>http.code</param>
						<value>307</value>
					</equal>
					<equal>
						<param>http.content-length</param>
						<value>0</value>
					</equal>
					<contains>
						<param>http.headers</param>
						<value>http.location</value>
					</contains>
				</guards>
			</transition>
		</state>		
		<state>
			<label>trigger11</label>
			<type>trigger</type>
			<transition>
				<to>normal12</to>
				<message>
					<url>component.webhdfs.hdfsurl</url>
					<path>/webhdfs/v1/user/pjgrace/input_data/iistructured_data.txt?op=CREATE&amp;user.name=pjgrace&amp;data=true</path>
					<method>PUT</method>
					<type>OTHER</type>
					<headers>
						<header>
							<name>http.content-type</name>
							<value>application/octet-stream</value>
						</header>
					</headers>
					<body>This is the beginning of the end of the beginning.</body>
				</message>
			</transition>
		</state>		
		<state>
			<label>normal12</label>
			<type>normal</type>
			<transition>
				<to>trigger16</to>
				<guards>
					<equal>
						<param>http.code</param>
						<value>201</value>
					</equal>
					<equal>
						<param>http.content-length</param>
						<value>0</value>
					</equal>
				</guards>
			</transition>
		</state>		
		<state>
			<label>normal15</label>
			<type>normal</type>
			<transition>
				<to>trigger19</to>
				<guards>
					<equal>
						<param>http.code</param>
						<value>200</value>
					</equal>
					<equal>
						<param>http.content-length</param>
						<value>50</value>
					</equal>
					<equal>
						<param>http.content-type</param>
						<value>application/octet-stream</value>
					</equal>
				</guards>
			</transition>
		</state>		
		<state>
			<label>trigger16</label>
			<type>trigger</type>
			<transition>
				<to>normal15</to>
				<message>
					<url>component.webhdfs.hdfsurl</url>
					<path>/webhdfs/v1/user/pjgrace/input_data/iistructured_data.txt?op=OPEN&amp;user.name=pjgrace</path>
					<method>GET</method>
					<type>OTHER</type>
					<headers>
						<header>
							<name>http.content-type</name>
							<value>application/octet-stream</value>
						</header>
					</headers>
					<body></body>
				</message>
			</transition>
		</state>		
		<state>
			<label>trigger19</label>
			<type>trigger</type>
			<transition>
				<to>normal20</to>
				<message>
					<url>component.webhdfs.hdfsurl</url>
					<path>/webhdfs/v1/user/pjgrace/input_data/iistructured_data.txt?op=APPEND&amp;user.name=pjgrace</path>
					<method>POST</method>
					<type>OTHER</type>
					<headers>
						<header>
							<name>http.content-type</name>
							<value>octet-stream</value>
						</header>
					</headers>
					<body></body>
				</message>
			</transition>
		</state>		
		<state>
			<label>normal20</label>
			<type>normal</type>
			<transition>
				<to>trigger21</to>
				<guards>
					<equal>
						<param>http.code</param>
						<value>307</value>
					</equal>
					<equal>
						<param>http.content-length</param>
						<value>0</value>
					</equal>
					<contains>
						<param>http.headers</param>
						<value>http.location</value>
					</contains>
				</guards>
			</transition>
		</state>		
		<state>
			<label>trigger21</label>
			<type>trigger</type>
			<transition>
				<to>normal22</to>
				<message>
					<url>component.webhdfs.hdfsurl</url>
					<path>/webhdfs/v1/user/pjgrace/input_data/iistructured_data.txt?op=APPEND&amp;user.name=pjgrace&amp;data=true&amp;user.name=pjgrace</path>
					<method>POST</method>
					<type>OTHER</type>
					<headers>
						<header>
							<name>http.content-type</name>
							<value>application/octet-stream</value>
						</header>
					</headers>
					<body>1234567891012131455555555</body>
				</message>
			</transition>
		</state>		
		<state>
			<label>normal22</label>
			<type>normal</type>
			<transition>
				<to>trigger23</to>
				<guards>
					<equal>
						<param>http.code</param>
						<value>200</value>
					</equal>
					<equal>
						<param>http.content-length</param>
						<value>0</value>
					</equal>
					<equal>
						<param>http.content-type</param>
						<value>application/json</value>
					</equal>
				</guards>
			</transition>
		</state>		
		<state>
			<label>trigger23</label>
			<type>trigger</type>
			<transition>
				<to>normal29</to>
				<message>
					<url>component.webhdfs.hdfsurl</url>
					<path>/webhdfs/v1/user/pjgrace/input_data/iistructured_data.txt?op=DELETE&amp;user.name=pjgrace&amp;data=true</path>
					<method>DELETE</method>
					<type>XML</type>
					<headers>
						<header>
							<name>http.content-type</name>
							<value>application/json</value>
						</header>
					</headers>
					<body><![CDATA[]]></body>
				</message>
			</transition>
		</state>		
		<state>
			<label>normal29</label>
			<type>normal</type>
			<transition>
				<to>end5</to>
				<guards>
					<equal>
						<param>http.code</param>
						<value>200</value>
					</equal>
					<equal>
						<param>http.content-type</param>
						<value>application/json</value>
					</equal>
					<equal>
						<param>Content[$.boolean]</param>
						<value>true</value>
					</equal>
				</guards>
			</transition>
		</state>
	</behaviour>
</pattern>